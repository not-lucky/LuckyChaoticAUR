<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LuckyChaoticAUR - Arch Linux Package Repository</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>LuckyChaoticAUR</h1>
            <p class="subtitle">Personal Arch Linux Package Repository</p>
        </div>
    </header>

    <main class="container">
        <section class="status-bar">
            <div class="status-item">
                <span class="label">Packages:</span>
                <span class="value" id="package-count">--</span>
            </div>
            <div class="status-item">
                <span class="label">Last Updated:</span>
                <span class="value" id="last-updated">--</span>
            </div>
            <div class="status-item">
                <span class="label">Architecture:</span>
                <span class="value">x86_64</span>
            </div>
        </section>

        <section class="installation">
            <h2>Installation</h2>
            <p>Add this repository to your <code>/etc/pacman.conf</code>:</p>
            <pre><code>[luckychaoticaur]
SigLevel = Optional TrustAll
Server = https://luckychaoticaur.github.io/LuckyChaoticAUR/$arch</code></pre>
            <p>Then sync and install packages:</p>
            <pre><code>sudo pacman -Sy
sudo pacman -S &lt;package-name&gt;</code></pre>
        </section>

        <section class="packages">
            <h2>Available Packages</h2>
            <div class="search-box">
                <input type="text" id="search" placeholder="Search packages..." autocomplete="off">
            </div>
            <table id="package-table">
                <thead>
                    <tr>
                        <th>Package</th>
                        <th>Version</th>
                        <th>Description</th>
                        <th>Built</th>
                    </tr>
                </thead>
                <tbody id="package-list">
                    <!-- Populated by JavaScript or generate-index.py -->
                    <tr class="placeholder">
                        <td colspan="4">Loading packages...</td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>
                Powered by <a href="https://github.com/LuckyChaoticAUR/LuckyChaoticAUR">LuckyChaoticAUR</a> |
                Packages sourced from <a href="https://aur.archlinux.org">AUR</a>
            </p>
        </div>
    </footer>

    <script>
        // Load package data from packages.json if available
        async function loadPackages() {
            try {
                const response = await fetch('packages.json');
                if (!response.ok) throw new Error('packages.json not found');
                const data = await response.json();

                document.getElementById('package-count').textContent = data.packages.length;
                document.getElementById('last-updated').textContent = data.last_updated || 'Unknown';

                const tbody = document.getElementById('package-list');
                tbody.innerHTML = '';

                data.packages.forEach(pkg => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><a href="https://aur.archlinux.org/packages/${pkg.name}" target="_blank">${pkg.name}</a></td>
                        <td><code>${pkg.version}</code></td>
                        <td>${pkg.description || '-'}</td>
                        <td>${pkg.build_date || '-'}</td>
                    `;
                    tbody.appendChild(row);
                });
            } catch (e) {
                console.log('Could not load packages.json:', e.message);
            }
        }

        // Search functionality
        document.getElementById('search').addEventListener('input', function(e) {
            const filter = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#package-list tr:not(.placeholder)');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(filter) ? '' : 'none';
            });
        });

        loadPackages();
    </script>
</body>
</html>
